PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX dcsso: <http://www.dei.unipd.it/db2/dcsso#>
select ?tn ?maxxP ?s ?ln ?realPoints ?realPosition where{
	?t foaf:name ?tn;
       dcsso:participatesIn/foaf:name ?ln;
       dcsso:hasParticipation ?p.
    ?p dcsso:season ?s;
       dcsso:xPoints ?xP;
       dcsso:points ?realPoints;
       dcsso:finalPosition ?realPosition.
{
    select ?lnInt (MAX(?xPInt) as ?maxxP) ?sInt where { 
        ?t dcsso:participatesIn/foaf:name ?lnInt;
           dcsso:hasParticipation ?p.
        ?p dcsso:season ?sInt;
           dcsso:xPoints ?xPInt.
    }
    GROUP BY ?sInt ?lnInt
}
    FILTER(?xP = ?maxxP && ?s = ?sInt && ?ln = ?lnInt)
}
ORDER BY asc (?ln) asc (?sInt)